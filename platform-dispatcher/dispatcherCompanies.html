<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Companies</title>

  <!-- External CSS -->
    <link
      rel="stylesheet"
      href="../assets/css/bootstrap.min.css"/>
    <link
      rel="stylesheet"
      href="../assets/css/all.min.css"/>
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css"/>

    <link rel="stylesheet" href="styles.css" />

    <!-- Internal Style -->
    <style>
      .search-filter-wrapper {
        background: #fff;
        border-radius: 14px;
        padding: 20px;
        display: flex;
        gap: 15px;
        flex-wrap: wrap;
        border: 1px solid #eee;
      }
      .search-box {
        flex: 1;
        min-width: 250px;
        background: #f3f3f5;
        border-radius: 12px;
        padding: 10px 15px;
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .search-box input {
        border: none;
        outline: none;
        background: transparent;
        width: 100%;
      }
      .filter-box {
        background: #f3f3f5;
        border-radius: 12px;
        padding: 10px 15px;
        min-width: 160px;
      }
      .filter-box select {
        border: none;
        background: transparent;
        outline: none;
        width: 100%;
        cursor: pointer;
      }

      .card-box {
        background: #fff;
        border-radius: 14px;
        padding: 20px;
        border: 1px solid #eee;
        margin-top: 15px;
      }
      .service-tag {
        background: #eceef2;
        border-radius: 14px;
        padding: 4px 10px;
        font-size: 11px;
        margin: 2px;
        display: inline-block;
      }
      .status-badge {
        padding: 4px 10px;
        border-radius: 10px;
        font-size: 12px;
        color: #fff;
      }
      .status-active {
        background: #00a63e;
      }
      .status-suspended {
        background: #d4183d;
      }

      .action-link {
        text-decoration: none;
        color: #0a0a0a;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 6px;
      }
      /* ===== Center DataTables Pagination ===== */
    .dataTables_wrapper .dataTables_paginate {
        display: flex !important;
        justify-content: center !important;
        background-color: #ffff;
        border-radius: 8px;
        width: 100%;
        margin-top: 15px;
    }

    .dataTables_wrapper .dataTables_paginate .pagination {
        justify-content: center !important;
    }

    .dataTables_wrapper .dataTables_paginate .page-item {
        margin: 0 4px;
    }
    </style>
  </head>

  <body>
    <!-- NAVBAR -->
    <nav class="navbar">
      <div class="logo"><span>LS</span> LockSmith Platform</div>

      <div class="nav-links">
        <a href="dashboard.html"><i class="fa fa-house"></i> Dashboard</a>
        <a href="newJob.html"><i class="fa fa-plus"></i> New Job</a>
        <a href="jobHistory.html" href="#"><i class="fa-solid fa-list-ul"></i> Job History</a>
        <a href="dispatcherCompanies.html" ><i class="fa-regular fa-map"></i> Companies</a>
        <a href="customers.html" >Customers</a>
    </div>

      <div class="profile"><i class="fa fa-user"></i> Dispatcher</div>

      <div class="toggle-sidebar" id="toggleSidebar">
        <i class="fa fa-bars"></i>
      </div>
    </nav>

    <!-- SIDEBAR -->
    <aside class="sidebar" id="sidebar">
      <a href="dashboard.html"><i class="fa fa-house"></i> Dashboard</a>
      <a href="newJob.html"><i class="fa fa-plus"></i> New Job</a>
      <a href="jobHistory.html"><i class="fa-solid fa-list-ul"></i> Job History</a>
      <a href="dispatcherCompanies.html"><i class="fa-regular fa-map"></i> Companies</a>
      <a href="customers.html" >Customers</a>
    </aside>

    <!-- MAIN CONTENT-->
    <main class="mainContent" id="mainContent">
      <!-- Filters -->
      <div class="search-filter-wrapper">
        <div class="search-box">
          <i class="fa fa-search text-muted"></i>
          <input id="globalSearch" placeholder="Search by name, ID, phone..." />
        </div>

        <div class="filter-box">
          <select id="statusFilter">
            <option value="">All Status</option>
            <option value="Active">Active</option>
            <option value="Suspended">Suspended</option>
          </select>
        </div>

        <div class="filter-box">
          <select id="cityFilter">
            <option value="">All Cities</option>
            <option>Downtown District</option>
            <option>North Zone</option>
            <option>West Side</option>
            <option>East End</option>
          </select>
        </div>

        <div class="filter-box">
          <select id="serviceFilter">
            <option value="">All Services</option>
            <option>Plumbing</option>
            <option>Heating</option>
            <option>Electrical</option>
            <option>HVAC</option>
            <option>Locksmith</option>
          </select>
        </div>
      </div>

      <!-- Table -->
      <div class="card-box">
      <h5 class="fw-bold mb-3">Companies Listing</h5>
      <p class="text-muted">8 companies found</p>
      <div  class="table-responsive mt-3">
        <table id="companiesTable" class="table w-100">
          <thead>
            <tr>
              <th>Company Name</th>
              <th>Company ID</th>
              <th>City/Area</th>
              <th>Services Types</th>
              <th>Active Technicians</th>
              <th>Status</th>
              <th>Contact Person</th>
              <th>Contact Phone</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      </div>
    </main>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
    <script src="../assets/js/bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>

    <!-- Internal Scripts -->
    <script>
      const companies = [
        {
          name: "ABC Plumbing",
          id: "CMP-001",
          city: "Downtown District",
          services: ["Plumbing", "Heating"],
          tech: 12,
          status: "Active",
          person: "John Doe",
          phone: "555-0101",
        },
        {
          name: "ElectroTech",
          id: "CMP-002",
          city: "North Zone",
          services: ["Electrical", "HVAC"],
          tech: 8,
          status: "Active",
          person: "John Doe",
          phone: "555-0102",
        },
        {
          name: "CoolBreeze",
          id: "CMP-003",
          city: "West Side",
          services: ["HVAC"],
          tech: 15,
          status: "Active",
          person: "John Doe",
          phone: "555-0103",
        },
        {
          name: "Premier Electric",
          id: "CMP-004",
          city: "Downtown District",
          services: ["Electrical"],
          tech: 6,
          status: "Suspended",
          person: "John Doe",
          phone: "555-0104",
        },
        {
          name: "QuickFix Lock",
          id: "CMP-005",
          city: "East End",
          services: ["Locksmith"],
          tech: 3,
          status: "Active",
          person: "John Doe",
          phone: "555-0105",
        },
        {
          name: "City Heating",
          id: "CMP-006",
          city: "North Zone",
          services: ["Heating"],
          tech: 9,
          status: "Active",
          person: "John Doe",
          phone: "555-0106",
        },
        {
          name: "Metro Plumbers",
          id: "CMP-007",
          city: "West Side",
          services: ["Plumbing"],
          tech: 11,
          status: "Suspended",
          person: "John Doe",
          phone: "555-0107",
        },
        {
          name: "Alpha HVAC",
          id: "CMP-008",
          city: "Downtown District",
          services: ["HVAC"],
          tech: 20,
          status: "Active",
          person: "John Doe",
          phone: "555-0108",
        },
      ];

      let table;

      $(document).ready(function () {
        table = $("#companiesTable").DataTable({
          data: companies,
          dom: "rtp",
          pageLength: 5,
          columns: [
            { data: "name" },
            { data: "id" },
            { data: "city" },
            {
              data: "services",
              render: (s) =>
                s.map((x) => `<span class="service-tag">${x}</span>`).join(""),
            },
            { data: "tech" },
            {
              data: "status",
              render: (s) =>
                `<span class="status-badge ${s === "Active" ? "status-active" : "status-suspended"}">${s}</span>`,
            },
            { data: "person" },
            { data: "phone" },
            {
              data: null,
              render: (d) => `
      <a href="companyDetails.html?id=${d.id}" class="action-link">
        <i class="fa fa-eye"></i> View
      </a>`,
            },
          ],
        });

        // Filters
        $("#globalSearch").on("keyup", function () {
          table.search(this.value).draw();
        });

        $("#statusFilter").on("change", function () {
          const v = this.value;
          table
            .column(5)
            .search(v ? `^${v}$` : "", true, false)
            .draw();
        });

        $("#cityFilter").on("change", function () {
          table.column(2).search(this.value).draw();
        });

        $("#serviceFilter").on("change", function () {
          table.column(3).search(this.value).draw();
        });
      });
    </script>
  </body>
</html>

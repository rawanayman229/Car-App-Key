


<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Dispatcher Companies & Customers</title>

<!-- CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css"/>

<style>
.search-filter-wrapper{background:#fff;border-radius:14px;padding:20px;display:flex;gap:15px;flex-wrap:wrap;border:1px solid #eee}
.search-box{flex:1;min-width:250px;background:#f3f3f5;border-radius:12px;padding:10px 15px;display:flex;align-items:center;gap:10px}
.search-box input{border:none;outline:none;background:transparent;width:100%}
.filter-box{background:#f3f3f5;border-radius:12px;padding:10px 15px;min-width:160px}

.custom-tabs{display:inline-flex;gap:6px;margin-top:20px;background:#f3f3f5;padding:6px;border-radius:14px}
.custom-tab{padding:6px 16px;border-radius:999px;cursor:pointer;font-size:14px}
.custom-tab.active{background:#fff;box-shadow:0 2px 5px rgba(0,0,0,.05)}

.card-box{background:#fff;border-radius:14px;padding:20px;border:1px solid #eee;margin-top:15px}

.status-badge{padding:4px 10px;border-radius:10px;font-size:12px;color:#fff}
.status-active{background:#030213}
.status-suspended{background:#d4183d}
.status-inactive{background:#ECEEF2;color:#030213}

.service-tag{background:#ECEEF2;border-radius:14px;padding:4px 10px;font-size:11px;margin:2px;display:inline-block}

.action-view{display:flex;gap:6px;cursor:pointer;font-weight:500}

.dataTables_wrapper .dataTables_paginate{display:flex!important;justify-content:center!important;margin-top:15px}
</style>
</head>

<body class="p-4">

<!-- Filters -->
<div class="search-filter-wrapper">
  <div class="search-box">
    <i class="fas fa-search"></i>
    <input type="text" id="globalSearch" placeholder="Search..."/>
  </div>

  <div class="filter-box">
    <select id="statusFilter"></select>
  </div>

  <div class="filter-box">
    <select id="cityFilter">
      <option value="">All Cities</option>
      <option>Downtown District</option>
      <option>North Zone</option>
      <option>West Side</option>
      <option>East End</option>
    </select>
  </div>

  <div class="filter-box">
    <select id="serviceFilter">
      <option value="">All Services</option>
      <option>Plumbing</option>
      <option>Heating</option>
      <option>Electrical</option>
      <option>HVAC</option>
      <option>Locksmith</option>
    </select>
  </div>
</div>

<!-- Tabs -->
<div class="custom-tabs">
  <div class="custom-tab active" data-tab="companies">Companies</div>
  <div class="custom-tab" data-tab="customers">Customers</div>
</div>

<div class="card-box">
  <div class="mb-4">
    <h5 id="listingTitle" class="fw-bold m-0">Companies Listing</h5>
    <p id="listingCount" class="text-muted">0 found</p>
  </div>

  <!-- Companies -->
  <div id="companiesTableWrapper">
    <table id="companiesTable" class="table w-100">
      <thead>
        <tr>
          <th>Name</th><th>ID</th><th>City</th><th>Services</th>
          <th>Tech</th><th>Status</th><th>Contact</th><th>Phone</th><th>Action</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- Customers -->
  <div id="customersTableWrapper" style="display:none">
    <table id="customersTable" class="table w-100">
      <thead>
        <tr>
          <th>Name</th><th>ID</th><th>Phone</th><th>Email</th>
          <th>City</th><th>Jobs</th><th>Date</th><th>Status</th><th>Action</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<!-- Scripts -->
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>

<script>
/* ================= DATA ================= */
const companies = [
 {name:"ABC Plumbing",id:"CMP-001",city:"Downtown District",services:["Plumbing","Heating"],tech:12,status:"Active",person:"John",phone:"555-0101"},
 {name:"ElectroTech",id:"CMP-002",city:"North Zone",services:["Electrical","HVAC"],tech:8,status:"Suspended",person:"Ali",phone:"555-0102"},
 {name:"Alpha HVAC",id:"CMP-003",city:"West Side",services:["HVAC"],tech:20,status:"Active",person:"Sara",phone:"555-0103"},
];

const customers = [
 {name:"Adam",id:"CUS-001",phone:"555-1111",email:"a@mail.com",city:"North Zone",jobs:6,date:"2024-02-18",status:"Active"},
 {name:"Mona",id:"CUS-002",phone:"555-2222",email:"m@mail.com",city:"West Side",jobs:2,date:"2024-03-10",status:"Inactive"},
 {name:"Omar",id:"CUS-003",phone:"555-3333",email:"o@mail.com",city:"East End",jobs:4,date:"2024-01-05",status:"Active"},
];

let currentTab = "companies";
let companiesTable, customersTable;

$(document).ready(function(){

/* ===== INIT TABLES ===== */
companiesTable = $("#companiesTable").DataTable({
 data:companies,
 dom:"rtp",
 pageLength:5,
 columns:[
  {data:"name"},{data:"id"},{data:"city"},
  {data:"services",render:s=>s.map(x=>`<span class="service-tag">${x}</span>`).join("")},
  {data:"tech"},
  {data:"status",render:s=>`<span class="status-badge ${s==="Active"?"status-active":"status-suspended"}">${s}</span>`},
  {data:"person"},{data:"phone"},
  {data:null,render:()=>`<div class="action-view"><i class="fa fa-eye"></i> View</div>`}
 ]
});

customersTable = $("#customersTable").DataTable({
 data:customers,
 dom:"rtp",
 pageLength:5,
 columns:[
  {data:"name"},{data:"id"},{data:"phone"},{data:"email"},
  {data:"city"},{data:"jobs"},{data:"date"},
  {data:"status",render:s=>`<span class="status-badge ${s==="Active"?"status-active":"status-inactive"}">${s}</span>`},
  {data:null,render:()=>`<div class="action-view"><i class="fa fa-eye"></i> View</div>`}
 ]
});

/* ===== INITIAL UI STATE ===== */
setStatusOptions();
updateHeader();

/* ================= FILTERS ================= */
$("#globalSearch").on("keyup",function(){
 if(currentTab==="companies"){
   companiesTable.search(this.value).draw();
 }else{
   customersTable.search(this.value).draw();
 }
});

$("#statusFilter").on("change",function(){
 let v = this.value;

 if(currentTab==="companies"){
   companiesTable.column(5).search(v ? `^${v}$` : "", true, false).draw();
 }else{
   customersTable.column(7).search(v ? `^${v}$` : "", true, false).draw();
 }
 updateHeader();
});

$("#cityFilter").on("change",function(){
 let v=this.value;
 if(currentTab==="companies"){
   companiesTable.column(2).search(v).draw();
 }else{
   customersTable.column(4).search(v).draw();
 }
 updateHeader();
});

$("#serviceFilter").on("change",function(){
 if(currentTab==="companies"){
   companiesTable.column(3).search(this.value).draw();
 }
 updateHeader();
});

/* ================= TABS ================= */
$(".custom-tab").on("click",function(){

 $(".custom-tab").removeClass("active");
 $(this).addClass("active");

 currentTab = $(this).data("tab");

 // reset filters
 $("#globalSearch").val("");
 $("#cityFilter").val("");
 $("#serviceFilter").val("");

 companiesTable.search("").columns().search("").draw();
 customersTable.search("").columns().search("").draw();

 if(currentTab==="companies"){
   $("#companiesTableWrapper").show();
   $("#customersTableWrapper").hide();
   $("#serviceFilter").prop("disabled",false).parent().css("opacity","1");
 }else{
   $("#companiesTableWrapper").hide();
   $("#customersTableWrapper").show();
   $("#serviceFilter").prop("disabled",true).val("").parent().css("opacity",".5");
 }

 setStatusOptions();
 updateHeader();
});

/* ================= FUNCTIONS ================= */
function updateHeader(){
 if(currentTab==="companies"){
   const count = companiesTable.rows({filter:"applied"}).count();
   $("#listingTitle").text("Companies Listing");
   $("#listingCount").text(`${count} companies found`);
 }else{
   const count = customersTable.rows({filter:"applied"}).count();
   $("#listingTitle").text("Customers Listing");
   $("#listingCount").text(`${count} customers found`);
 }
}

function setStatusOptions(){
 let html = `<option value="">All Status</option>`;
 if(currentTab==="companies"){
   html += `<option value="Active">Active</option><option value="Suspended">Suspended</option>`;
 }else{
   html += `<option value="Active">Active</option><option value="Inactive">Inactive</option>`;
 }
 $("#statusFilter").html(html);
}

});
</script>

</body>
</html>
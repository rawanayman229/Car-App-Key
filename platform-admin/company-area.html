   <!doctype html>
   <html lang="en">
   <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Areas</title>

    <!-- CSS Links-->
    <link rel="stylesheet" href="../assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="../assets/css/apexcharts.css" />
    <link rel="stylesheet" href="../assets/css/all.min.css" />
    <link rel="stylesheet" href="../assets/css/styles.css" />
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css"/>
  </head>
  <body>
    <!-- Start Of Static Section (Side Bar) -->

    <!-- Sidebar Toggle Overlay (Mobile and Tablet) -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- ===== Sidebar (Desktop) ===== -->
    <aside class="sidebar d-flex flex-column" id="sidebar">
      <!-- 1. Header Section -->
      <div class="sidebar-header">
        <!-- Logo Text -->
        <div class="logo">
          <h4>LockAccess Pro</h4>
          <p>Platform Admin</p>
        </div>

        <!-- Close button (Mobile) -->
        <button class="btn d-md-none text-muted" id="closeSidebar">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <!-- 2. Navigation Menu -->
      <ul class="menu flex-grow-1">
        <li data-page="dashboard" class="active">
          <a href="dashboard.html">
            <i class="fa-solid fa-table-cells-large"></i>
            Dashboard
          </a>
        </li>

        <li data-page="companies">
          <a href="companies.html">
            <i class="fa-regular fa-building"></i>
            Companies
          </a>
        </li>

          <li data-page="company-area">
          <a href="company-area.html">
            <i class="fa-regular fa-building"></i>
            Company Area
          </a>
        </li>

        <li data-page="reports">
          <a href="reports.html">
            <i class="fa-regular fa-file-lines"></i>
            Reports
          </a>
        </li>

        <li data-page="jobs">
          <a href="jobs.html">
            <i class="fa-solid fa-user-group"></i>
            Jobs
          </a>
        </li>

        <li data-page="notifications">
          <a href="notifications.html">
            <i class="fa-regular fa-bell"></i>
            Notifications
          </a>
        </li>

        <li data-page="customers">
          <a href="customers.html">
            <i class="fa-solid fa-user-group"></i>
            Customer
          </a>
        </li>

        <li data-page="users">
          <a href="users.html">
            <i class="fa-solid fa-user-group"></i>
            Users
          </a>
        </li>

          <li data-page="calls">
          <a href="calls.html">
          <i class="fa-solid fa-mobile-screen"></i> Call Logs
          </a>
        </li>
      </ul>
      <!-- 3. Sidebar Footer (User Profile) -->
      <div class="sidebar-footer">
        <div class="d-flex align-items-center gap-3">
          <!-- Avatar Circle -->
          <div class="user-avatar" id="userAvatar">U</div>

          <!-- Text Info -->
          <div class="user-info">
            <h6 id="sidebarUsername">User</h6>
            <small id="sidebarEmail">user@email.com</small>
          </div>
        </div>
      </div>
    </aside>
    <!-- End OF Sidebar -->

    <div class="main-wrapper" id="mainWrapper">
    <!-- Header -->
     <main>
     <div class="d-flex justify-content-between mb-4">
      <div class="d-flex flex-column justify-content-left">
        <h3 class="page-title">Areas</h3>
        <p class="page-subtitle">Manage predefined area values for companies and jobs.</p>
      </div>

        <!-- Add Area Button -->
        <div class="col-lg-2">
          <button class="btn add-btn w-100" data-bs-toggle="modal" data-bs-target="#addAreaModal">
            <i class="fas fa-plus me-2"></i> Add Area
          </button>
        </div>
      </div>

      <div class="row content gap-3 align-items-center mb-3">
        <!-- ===== Search + Filter Section ===== -->
        <!-- Search -->
        <div class="col-lg-7">
          <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" id="customSearch" placeholder="Search by area name, city, or country..." />
          </div>
        </div>

        <!-- Status Filter -->
        <div class="select-box col-lg-2">
          <i class="fa-solid fa-angle-down"></i>
          <select id="statusFilter">
            <option value="">All Statuses</option>
            <option>Active</option>
            <option>Inactive</option>
          </select>
        </div>

        <!-- City Filter -->
        <div class="select-box col-lg-2">
          <i class="fa-solid fa-angle-down"></i>
          <select id="cityFilter">
            <option value="">All Cities</option>
            <option>New York</option>
            <option>London</option>
            <option>Austin</option>
            <option>San Francisco</option>
          </select>
        </div>
        </div>

      <!-- Table -->
      <div class="card-box">
      <div  class="table-responsive mt-3">
        <table id="areasTable" class="table w-100">
          <thead>
            <tr>
              <th>Area Name</th>
              <th>City</th>
              <th>State / Region</th>
              <th>Country</th>
              <th>Status</th>
              <th>Created At</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      </div>
    </main>
    </div>

    <!-- Add Area Modal -->
    <div class="modal fade" id="addAreaModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content add-area-modal">

      <!-- Header -->
      <div class="modal-header border-0 pb-0">
        <h5 class="modal-title fw-bold">Add New Area</h5>
        <P class="modal-subtitle">Fill in the details to create a new area</P>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <!-- Body -->
      <div class="modal-body pt-2">

        <!-- Area Name -->
        <div class="mb-3">
          <label class="form-label">Area Name  <span class="required"></span></label>
          <input id="areaName" type="text" class="form-control" placeholder="e.g., Downtown Business District" required>
        </div>

        <!-- City  -->
        <div class="mb-3">
          <label class="form-label">City <span class="required"></span></label>
          <input id="city" type="text" class="form-control" placeholder="e.g., San Francisco" required>
        </div>

        <!-- State / Region -->
        <div class="mb-3">
          <label class="form-label">State / Region</label>
          <input id="state" type="text" class="form-control" placeholder="e.g., California">
        </div>

          <!-- Country  -->
        <div class="mb-3">
          <label class="form-label">Country <span class="required"></span> </label>
          <input id="country" type="text" class="form-control" placeholder="e.g., United States" required>
        </div>

        <!-- Status -->
        <div class="mb-3">
          <label class="form-label">Status</label>
          <select id="status" class="form-select">
            <option>Active</option>
            <option>In Active</option>
          </select>
        </div>
      </div>

      <!-- Footer -->
      <div class="modal-footer">
        <button class="btn cancel-btn " data-bs-dismiss="modal">
          Cancel
        </button>
        <button id="createAreaBtn" class="btn create-btn px-5">
         Create Area
        </button>
      </div>

    </div>
    </div>
    </div>
    <!-- End Of Add User Modal -->

    <!-- JS Files -->
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
    <script src="../assets/js/bootstrap.bundle.min.js"></script>
    <script src="../assets/js/apexcharts.min.js"></script>
    <script src="../assets/js/script.js"></script>

     <!-- Internal Script -->
    <script>

      // Inintal Table
      let areasTable;
      const AREAS = [
        {
          name: "Downtown Business District",
          city: "San Francisco",
          state: "California",
          country: "United States",
          status: "Active",
          date: "Jan 15, 2024",
        },
      {
          name: "Tech Park North",
          city: "Austin",
          state: "Texas",
          country: "United States",
          status: "Active",
          date: "Feb 20, 2024",
        },
        {
          name: "Financial District",
          city: "New York",
          state: "New York",
          country: "United States",
          status: "Active",
          date: "Jan 15, 2024",
        },
        {
          name: "Downtown Business District",
          city: "New York",
          state: "New York",
          country: "United States",
          status: "Inactive",
          date: "Jan 15, 2024",
        },
        {
          name: "Downtown Business District",
          city: "London",
          state: "England",
          country: "United Kingdom",
          status: "Active",
          date: "Jan 15, 2024",
        },
        {
          name: "Downtown Business District",
          city: "Austin",
          state: "Texas",
          country: "United States",
          status: "Inactive",
          date: "Jan 15, 2024",
        },
        {
          name: "Downtown Business District",
          city: "Austin",
          state: "Texas",
          country: "United States",
          status: "Inactive",
          date: "Jan 15, 2024",
        },
        {
          name: "Downtown Business District",
          city: "Austin",
          state: "Texas",
          country: "United States",
          status: "Inactive",
          date: "Jan 15, 2024",
        },
      ];

      $(document).ready(function () {
        areasTable = initDataTable("#areasTable", AREAS, [
          { data: "name" },
          { data: "city" },
          { data: "state" },
          { data: "country" },
          {
            data: "status",
            render: (d) => renderStatusBadge(d),
          },
          { data: "date" },
          {
        data: null,
        render: (d) => `
         <button class="btn btn-sm edit-btn">
          <i class="fa-solid fa-pen"></i> Edit
        </button>`,
            },
        ]);

    /* EDIT ROW */
    $('#areasTable').on('click', '.edit-btn', function () {

    const btn = $(this);
    const tr = btn.closest('tr');
    const row = areasTable.row(tr);
    const data = row.data();

    /* SAVE MODE */
    if (tr.hasClass("editing")) {

    const inputs = tr.find("input,select");

    data.name = inputs.eq(0).val();
    data.city = inputs.eq(1).val();
    data.state = inputs.eq(2).val();
    data.country = inputs.eq(3).val();
    data.status = inputs.eq(4).val();

    row.data(data).draw(false);
    tr.removeClass("editing");

    btn.html('<i class="fa-regular fa-pen-to-square"></i>');
    return;
  }

    /* EDIT MODE */
    tr.addClass("editing");

    tr.find("td").eq(0).html(`
    <input class="form-control form-control-sm" value="${data.name}">`);

    tr.find("td").eq(1).html(`
    <input class="form-control form-control-sm" value="${data.city}">`);

      tr.find("td").eq(2).html(`
    <input class="form-control form-control-sm" value="${data.state}">`);

    tr.find("td").eq(3).html(`
    <input class="form-control form-control-sm" value="${data.country}">`);

    tr.find("td").eq(4).html(`
    <select class="form-select form-select-sm">
      <option ${data.status=="Active"?"selected":""}>Active</option>
      <option ${data.status=="In Active"?"selected":""}>In Active</option>
    </select>`);

    btn.html('<i class="fa-solid fa-check"></i>');
    });

        /* Search */
        $("#customSearch").on("keyup", function () {
          areasTable.search(this.value).draw();
        });

       /* Status Filter */
      $("#statusFilter").on("change", function () {
      const val = this.value;

    areasTable
    .column(4)
    .search(val ? "^" + val + "$" : "", true, false)
    .draw();
        });

      /* City Filter */
      $("#cityFilter").on("change", function () {
      const val = this.value;

    areasTable
    .column(1)
    .search(val ? "^" + val + "$" : "", true, false)
    .draw();
        });

      // Add Area Modal Logic
      document.getElementById("createAreaBtn").addEventListener("click", function () {
      const areaName = document.getElementById("areaName");
      const city = document.getElementById("city");
      const country = document.getElementById("country");
      const status = document.getElementById("status");

      let valid = true;

  // clear previous errors
    document.querySelectorAll(".error-msg").forEach(e => e.remove());
    document.querySelectorAll(".is-invalid").forEach(e => e.classList.remove("is-invalid"));

    function showError(input, message) {
    input.classList.add("is-invalid");
    const err = document.createElement("div");
    err.className = "error-msg text-danger small mt-1";
    err.innerText = message;
    input.parentNode.appendChild(err);
    valid = false;
  }

  // validations
  if (!areaName.value.trim())
    showError(areaName, "Area Name required");

  // Add to table if valid
  if (valid) {
  const newArea = {
  name: areaName.value.trim(),
  city: city.value.trim(),
  state: document.getElementById("state").value.trim(),
  country: country.value.trim(),
  status: status.value,
  date: "Jan 10, 2024",
   };

  // add row to table
    areasTable.row.add(newArea).draw();

  // close modal
    const modal = bootstrap.Modal.getInstance(document.getElementById("addAreaModal"));
    modal.hide();

  // reset form
    [areaName, city, document.getElementById("state"), country].forEach(i => i.value = "");
    status.selectedIndex = 0; 
    }
    });
    });
    </script>
  </body>
  </html>

  <!doctype html>
  <html lang="en">
  <head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Jobs Management</title>
  <!-- CSS Links -->
  <link rel="stylesheet" href="../assets/css/bootstrap.min.css" />
  <link rel="stylesheet" href="../assets/css/all.min.css" />
  <link rel="stylesheet" href="../assets/css/styles.css" />
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css"/>

  <!-- Internal Style For Modals -->
  <style>
  /* ===== Jobs Tabs ===== */
  .jobs-tabs{
    display:flex;
    gap:12px;
    margin-top:10px;
  }

  .btn-tab{
    border-radius:12px;
    padding:8px 16px;
    font-size:14px;
    border:none;
    background:#f3f4f6;
    color:#374151;
    font-weight:600;
    transition:.2s;
  }

  .btn-tab.active{
    background:var(--primary-color);
    color:#fff;
  }

  .btn-tab.high{
    background:#FEF2F2;
    color:#E7000B;
  }

  .btn-tab.today{
    background:#F3F4F6;
    color:#374151;
}

  /* ===== Table badges ===== */
  .badge-soft{
    padding:6px 12px;
    border-radius:20px;
    font-weight:600;
    font-size:12px;
    display:inline-flex;
    align-items:center;
  }

  /* Status */
  .status-inprogress{background:#DBEAFE;color:#1E40AF;}
  .status-assigned{background:#F3E8FF;color:#8200DB;}
  .status-completed{background:#DCFCE7;color:#008236;}

  /* Priority */
  .priority-high{background:#FEF2F2;color:#E7000B;border-radius:20px;padding:6px 12px;font-size:12px;font-weight:400;}
  .priority-medium{background:#FEF3C7;color:#92400E;border-radius:20px;padding:6px 12px;font-size:12px;font-weight:400;}
  .priority-low{background:#DCFCE7;color:#008236;border-radius:20px;padding:6px 12px;font-size:12px;font-weight:400;}

  /* Links */
  .link-view{
    color:#2563eb;
    font-weight:600;
    text-decoration:none;
  }
  .link-view:hover{ text-decoration:underline; }

  /* Table wrapper  */
  .jobs-table-wrapper{
    border:0.8px solid #E5E7EB;
    border-radius:16px;
    margin-top:20px;
    overflow:hidden;
    box-shadow:0 2px 3px rgba(0,0,0,.06);
  }

  /* ===== Job Details Modal ===== */
  .job-modal-header{
    padding:24px;
    border-bottom:0.8px solid #E5E7EB;
  }

  .job-id-title{
    font-size:24px;
    font-weight:700;
    color:#101828;
  }

  .job-type-subtitle{
    font-size:14px;
    color:#6A7282;
  }

  /* Section title */
  .modal-section-title{
    font-size:15px;
    color:#0A0A0A;
    margin:16px 0 8px;
    font-weight:400;
  }

  /* Cards */
  .data-card{
    background:#F9FAFB;
    border-radius:10px;
    padding:14px 16px;
  }

  /* Key value rows */
  .info-row{
    display:flex;
    justify-content:space-between;
    font-size:14px;
    margin-bottom:6px;
  }

  .info-label{ 
    color: #4A5565; 
  }
  .info-value{ 
    color:#101828; 
    font-weight:400; 
  }

   /* Details table */
  .details-table{
    width:100%;
    font-size:13px;
  }
  .details-table td{
    padding:6px 0;
  }
  .d-label{ 
    color:#6A7282; 
  }
  .d-value{ 
    text-align:right; 
    font-weight:400; 
    color:#101828; }

  /* Scrollbar */
  .modal-dialog-scrollable .modal-body{
    max-height:75vh;
    overflow-y:auto;
  }

  .modal-body::-webkit-scrollbar{
    width:6px;
  }
  .modal-body::-webkit-scrollbar-track{
    background:#F1F5F9;
  }
  .modal-body::-webkit-scrollbar-thumb{
    background:#CBD5E1;
    border-radius:10px;
  }
  .modal-body::-webkit-scrollbar-thumb:hover{
    background:#94A3B8;
  }

  /* ================= Activity Timeline ================= */
  .activity-timeline{
    position:relative;
    padding-left:32px;
    margin-top:20px;
}

  .activity-timeline::before{
    content:"";
    position:absolute;
    left:10px;
    top:0;
    bottom:0;
    width:2px;
    background:#E5E7EB;
  }

  /* Timeline Item */
  .timeline-item{
    position:relative;
    margin-bottom:18px;
  }

  /* Dot */
  .timeline-dot{
    position:absolute;
    left:-27px;
    top:18px;
    width:10px;
    height:10px;
    border-radius:50%;
    background:#3B82F6;
  }

  /* Dot Colors */
  .dot-yellow{background:#F0B100;}
  .dot-blue{background:#2B7FFF;}
  .dot-purple{background:#AD46FF;}
  .dot-green{background:#00C950;}

  /* Card */
  .timeline-card{
    background:#fff;
    border:1px solid #E5E7EB;
    border-radius:14px;
    padding:14px 16px;
    box-shadow:0 1px 2px rgba(0,0,0,.04);
  }

  /* Header */
  .timeline-header{
    display:flex;
    justify-content:space-between;
    align-items:flex-start;
    gap:10px;
  }

  .timeline-time{
    font-size:12px;
    color:#6B7280;
    font-weight:600;
  }

  .timeline-title{
    font-size:14px;
    font-weight:700;
    color:#0F172A;
    margin-top:4px;
  }

  /* Subtitle */
  .timeline-desc{
    font-size:13px;
    color:#6B7280;
    margin-top:4px;
  }

  /* Badge */
  .timeline-badge{
    font-size:11px;
    padding:4px 10px;
    border-radius:20px;
    font-weight:600;
    display:inline-flex;
    align-items:center;
    gap:6px;
  }

  /* Badge Colors */
  .badge-yellow{background:#FEF9C3;color:#854D0E;}
  .badge-blue{background:#DBEAFE;color:#1E40AF;}
  .badge-purple{background:#F3E8FF;color:#6B21A8;}
  .badge-green{background:#DCFCE7;color:#166534;}
  .badge-orange{background:#FFEDD5;color:#9A3412;}

  /* Footer */
  .timeline-footer{
    margin-top:10px;
    padding-top:8px;
    border-top:1px dashed #E5E7EB;
    font-size:12px;
    color:#374151;
    display:flex;
    flex-wrap:wrap;
    gap:10px;
    align-items:center;
  }

  .meta-badge{
    background:#F3F4F6;
    padding:2px 8px;
    border-radius:10px;
    font-size:11px;
    font-weight:600;
  }

  /* Metadata Toggle */
  .meta-toggle{
    font-size:14px;
    color:#717182;
    cursor:pointer;
    font-weight:400;
    margin-top:6px;
    display:inline-block;
  }

  .meta-content{
    display:none;
    margin-top:6px;
    font-size:12px;
    color:#6B7280;
    background:#F9FAFB;
    padding:8px;
    border-radius:8px;
  }
</style>
</head>

  <body>
    <!-- Sidebar Toggle Overlay (Mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

  <!-- ===== Sidebar (Desktop) ===== -->
    <aside class="sidebar d-flex flex-column" id="sidebar">
      <!-- 1. Header Section -->
      <div class="sidebar-header">
        <!-- Logo Text -->
        <div class="logo">
          <h4>LockAccess Pro</h4>
          <p>Platform Admin</p>
        </div>

        <!-- Close button (Mobile) -->
        <button class="btn d-md-none text-muted" id="closeSidebar">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <!-- 2. Navigation Menu -->
      <ul class="menu flex-grow-1">
        <li data-page="dashboard" class="active">
          <a href="dashboard.html">
            <i class="fa-solid fa-table-cells-large"></i>
            Dashboard
          </a>
        </li>

        <li data-page="companies">
          <a href="companies.html">
            <i class="fa-regular fa-building"></i>
            Companies
          </a>
        </li>

        <li data-page="reports">
          <a href="reports.html">
            <i class="fa-regular fa-file-lines"></i>
            Reports
          </a>
        </li>

        <li data-page="jobs">
          <a href="jobs.html">
            <i class="fa-solid fa-user-group"></i>
            Jobs
          </a>
        </li>

        <li data-page="notifications">
          <a href="notifications.html">
            <i class="fa-regular fa-bell"></i>
            Notifications
          </a>
        </li>

        <li data-page="customers">
          <a href="customers.html">
            <i class="fa-solid fa-user-group"></i>
            Customer
          </a>
        </li>

        <li data-page="users">
          <a href="users.html">
            <i class="fa-solid fa-user-group"></i>
            Users
          </a>
        </li>

          <li data-page="calls">
          <a href="calls.html">
          <i class="fa-solid fa-mobile-screen"></i>Call Logs
          </a>
        </li>
      </ul>
      <!-- 3. Sidebar Footer (User Profile) -->
      <div class="sidebar-footer">
        <div class="d-flex align-items-center gap-3">
          <!-- Avatar Circle -->
          <div class="user-avatar" id="userAvatar">U</div>

          <!-- Text Info -->
          <div class="user-info">
            <h6 id="sidebarUsername">User</h6>
            <small id="sidebarEmail">user@email.com</small>
          </div>
        </div>
      </div>
    </aside>

  <!-- ===== Main Wrapper ===== -->
    <div class="main-wrapper" id="mainWrapper">
    
    <!-- 1. Mobile Header (Visible only on mobile/tablet) -->
    <div class="d-lg-none p-3 bg-white border-bottom d-flex align-items-center justify-content-between sticky-top">
      <h5 class="m-0 fw-bold text-dark">LockAccess Pro</h5>
      <button class="btn btn-light" id="toggleSidebar">
        <i class="fas fa-bars"></i>
      </button>
    </div>

    <!-- 2. Main Content Area -->
    <main class="mb-4">
      <!-- Page Header (Desktop View title) -->
      <div class="d-flex flex-column justify-content-left mb-4">
        <h3 class="page-title">Jobs Management</h3>
        <p class="page-subtitle">Monitor and manage all jobs across all companies.</p>
      </div>

      <!-- Main Data Content -->
      <div class="row content g-3 align-items-center">

      <!-- Search + Filter -->
      <div class="row g-3 align-items-center">
      <div class="col-lg-9">
      <div class="search-box">
        <i class="fas fa-search"></i>
        <input type="text" id="customSearch" placeholder="Search by job ID, company, customer, or type..." />
      </div>
      </div>

      <div class="col-lg-3 d-flex justify-content-end align-items-center gap-2">
      <i class="fas fa-filter text-muted"></i>
      <div class="select-box w-100">
        <select id="statusFilter">
          <option value="">All Status</option>
          <option value="Pending">Pending</option>
          <option value="Assigned">Assigned</option>
          <option value="In Progress">In Progress</option>
          <option value="Completed">Completed</option>
          <option value="Cancelled">Cancelled</option>
        </select>
      </div>
      </div>
      </div>

      <!-- Tabs -->
    <div class="jobs-tabs mt-3">
    <button class="btn-tab active" data-filter="all">All Jobs (6)</button>
    <button class="btn-tab high" data-filter="high">High Priority (3)</button>
    <button class="btn-tab today" data-filter="today">Today (5)</button>
    </div>

    <!-- Table -->
    <div class="table-responsive mt-3">
      <table id="jobsTable" class="table w-100">
        <thead>
          <tr>
            <th>Job ID</th>
            <th>Company</th>
            <th>Type</th>
            <th>Customer</th>
            <th>Technician</th>
            <th>Status</th>
            <th>Priority</th>
            <th>Amount</th>
            <th>whatsapp</th>
            <th>Details</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      </div>
      </div>

    <!-- JOB DETAILS MODAL  -->
    <div class="modal fade" id="jobDetailsModal" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content border-0 shadow-lg">

      <!-- Header -->
      <div class="modal-header job-modal-header">
        <div>
          <div class="job-id-title" id="modalJobId">JOB-1234</div>
          <div class="job-type-subtitle" id="modalJobType">Emergency Lockout</div>
        </div>
        <button class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <!-- Body -->
      <div class="modal-body px-4">

        <!-- Customer -->
        <div class="modal-section-title">Customer Information</div>
        <div class="data-card">
          <div class="info-row"><span class="info-label">Name</span><span class="info-value" id="modalCustName"></span></div>
          <div class="info-row"><span class="info-label">Address</span><span class="info-value" id="modalAddress">Dubai</span></div>
          <div class="info-row"><span class="info-label">Number</span><span class="info-value" id="modalNumber">01545455</span></div>
          <div class="info-row"><span class="info-label">Email</span><span class="info-value" id="modalEmail">example@gmail.com</span></div>
        </div>

        <!-- Schedule + Company -->
        <div class="row g-3 mt-2">
          <div class="col-md-6">
            <div class="modal-section-title">Schedule</div>
            <div class="data-card">
              <div class="info-row"><span class="info-label">Created</span><span class="info-value" id="modalCreated">2026-02-12 09:30 AM</span></div>
              <div class="info-row"><span class="info-label">Scheduled</span><span class="info-value" id="modalScheduled">2026-02-12 10:00 AM</span></div>
            </div>
          </div>

          <div class="col-md-6">
            <div class="modal-section-title">Company & Technician</div>
            <div class="data-card">
              <div class="info-row"><span class="info-value" id="modalCompany"></span></div>
              <div class="d-flex gap-2"><span class="info-label">Technician:</span><span class="info-value" id="modalTech"></span></div>
            </div>
          </div>
        </div>

        <!-- Job Details -->
        <div class="modal-section-title">Job Details</div>
        <div class="data-card">
          <table class="details-table">
            <tr>
              <td class="d-label">Status</td>
              <td class="d-value"><span id="modalStatusBadge"></span></td>
            </tr>
            <tr>
              <td class="d-label">Priority</td>
              <td class="d-value"><span id="modalPriorityBadge"></span></td>
            </tr>
            <tr>
              <td class="d-label">Key</td>
              <td class="d-value">Yes</td>
            </tr>
            <tr>
              <td class="d-label">Key price</td>
              <td class="d-value">$20</td>
            </tr>
            <tr>
              <td class="d-label">Code</td>
              <td class="d-value">Yes</td>
            </tr>
            <tr>
              <td class="d-label">Code price</td>
              <td class="d-value">$20</td>
            </tr>
            <tr>
              <td class="d-label">Pay the price of the service</td>
              <td class="d-value">Sami</td>
            </tr>
            <tr>
              <td class="d-label fw-bold pt-2">Total cost</td>
              <td class="d-value fw-bold pt-2" id="modalTotal">$250</td>
            </tr>
          </table>
        </div>

        <!-- Time Line  -->
    <div class="modal-section-title mt-4"> Activity Timeline 
    <div style="font-size:11px;color:#9CA3AF;">Showing 9 events
    </div> 
    </div>
    <div class="activity-timeline" id="activityTimeline">
    <!-- 1 -->
    <div class="timeline-item">
    <div class="timeline-dot dot-yellow"></div>
    <div class="timeline-card">
      <div class="timeline-header">
        <div>
          <div class="timeline-time">2:30 PM · Feb 22, 2026</div>
          <div class="timeline-title">Critical Issue Reported</div>
        </div>
        <span class="timeline-badge badge-yellow">
          <i class="fa-solid fa-file-lines"></i> Technician Report
        </span>
      </div>

      <div class="timeline-desc">Technician reported critical equipment malfunction</div>

      <div class="timeline-footer">
        <span><b>By:</b> Mike Johnson</span>
        <span><b>Role:</b> Technician</span>
        <span><b>IP:</b> 192.168.1.45</span>
        <span class="meta-badge">user</span>
      </div>

      <div class="meta-toggle"> <i class="fa-solid fa-chevron-down"></i> Click to view metadata</div>
      <div class="meta-content">Device: Mobile · OS: Android · App Version: 1.2.4</div>
    </div>
  </div>

  <!-- 2 -->
  <div class="timeline-item">
    <div class="timeline-dot dot-blue"></div>
    <div class="timeline-card">
      <div class="timeline-header">
        <div>
          <div class="timeline-time">12:15 PM · Feb 22, 2026</div>
          <div class="timeline-title">Status Updated</div>
        </div>
        <span class="timeline-badge badge-blue">
          <i class="fa-solid fa-clock"></i> Status Updated
        </span>
      </div>

      <div class="timeline-desc">
        <span class="meta-badge">In Progress</span> → <span class="meta-badge">On Hold</span>
      </div>

      <div class="timeline-footer">
        <span><b>By:</b> Sarah Williams</span>
        <span><b>Role:</b> Company Dispatcher</span>
        <span><b>IP:</b> 192.168.1.34</span>
        <span class="meta-badge">user</span>
      </div>
      <div class="meta-toggle"> <i class="fa-solid fa-chevron-down"></i> Click to view metadata</div>
      <div class="meta-content">Device: Mobile · OS: Android · App Version: 1.2.4</div>
    </div>
  </div>

  <!-- 3 -->
  <div class="timeline-item">
    <div class="timeline-dot dot-purple"></div>
    <div class="timeline-card">
      <div class="timeline-header">
        <div>
          <div class="timeline-time">10:07 AM · Feb 22, 2026</div>
          <div class="timeline-title">Technician Assigned</div>
        </div>
        <span class="timeline-badge badge-purple">
          <i class="fa-solid fa-user"></i> Technician Assigned
        </span>
      </div>

      <div class="timeline-desc">
        <span class="meta-badge">Unassigned</span> → <span class="meta-badge">Mike Johnson</span>
      </div>

      <div class="timeline-footer">
        <span><b>By:</b> Ahmed</span>
        <span><b>Role:</b> Platform Dispatcher</span>
        <span><b>IP:</b> 192.168.1.12</span>
        <span class="meta-badge">user</span>
      </div>
      <div class="meta-toggle"> <i class="fa-solid fa-chevron-down"></i> Click to view metadata</div>
      <div class="meta-content">Device: Mobile · OS: Android · App Version: 1.2.4</div>
    </div>
  </div>

  <!-- 4 -->
  <div class="timeline-item">
    <div class="timeline-dot dot-purple"></div>
    <div class="timeline-card">
      <div class="timeline-header">
        <div>
          <div class="timeline-time">9:45 AM · Feb 22, 2026</div>
          <div class="timeline-title">Company Accepted Job</div>
        </div>
        <span class="timeline-badge badge-purple">
          <i class="fa-solid fa-building"></i> Company Response
        </span>
      </div>

      <div class="timeline-desc">TechPro Services accepted the job assignment</div>

      <div class="timeline-footer">
        <span><b>By:</b> David Chen</span>
        <span><b>Role:</b> Company Admin</span>
        <span><b>IP:</b> 192.168.1.28</span>
        <span class="meta-badge">user</span>
      </div>
      <div class="meta-toggle"> <i class="fa-solid fa-chevron-down"></i> Click to view metadata</div>
      <div class="meta-content">Device: Mobile · OS: Android · App Version: 1.2.4</div>
    </div>
  </div>

  <!-- 5 -->
  <div class="timeline-item">
    <div class="timeline-dot dot-purple"></div>
    <div class="timeline-card">
      <div class="timeline-header">
        <div>
          <div class="timeline-time">9:30 AM · Feb 22, 2026</div>
          <div class="timeline-title">Company Assigned</div>
        </div>
        <span class="timeline-badge badge-purple">
          <i class="fa-solid fa-building-user"></i> Company Assigned
        </span>
      </div>

      <div class="timeline-desc">
        <span class="meta-badge">Pending</span> → <span class="meta-badge">Assigned to Company</span>
      </div>

      <div class="timeline-footer">
        <span><b>By:</b> Ahmed</span>
        <span><b>Role:</b> Platform Dispatcher</span>
        <span><b>IP:</b> 192.168.1.12</span>
        <span class="meta-badge">user</span>
      </div>
      <div class="meta-toggle"> <i class="fa-solid fa-chevron-down"></i> Click to view metadata</div>
      <div class="meta-content">Device: Mobile · OS: Android · App Version: 1.2.4</div>
    </div>
  </div>

  <!-- 6 -->
  <div class="timeline-item">
    <div class="timeline-dot dot-blue"></div>
    <div class="timeline-card">
      <div class="timeline-header">
        <div>
          <div class="timeline-time">9:15 AM · Feb 22, 2026</div>
          <div class="timeline-title">Status Updated</div>
        </div>
        <span class="timeline-badge badge-blue">
          <i class="fa-solid fa-clock"></i> Status Updated
        </span>
      </div>

      <div class="timeline-desc">
        <span class="meta-badge">New</span> → <span class="meta-badge">Pending</span>
      </div>

      <div class="timeline-footer">
        <span><b>By:</b> System Automation</span>
        <span><b>Role:</b> System</span>
        <span class="meta-badge">system</span>
      </div>
      <div class="meta-toggle"> <i class="fa-solid fa-chevron-down"></i> Click to view metadata</div>
      <div class="meta-content">Device: Mobile · OS: Android · App Version: 1.2.4</div>
    </div>
  </div>

  <!-- 7 -->
  <div class="timeline-item">
    <div class="timeline-dot dot-yellow"></div>
    <div class="timeline-card">
      <div class="timeline-header">
        <div>
          <div class="timeline-time">9:00 AM · Feb 22, 2026</div>
          <div class="timeline-title">Access Code Requested</div>
        </div>
        <span class="timeline-badge badge-yellow">
          <i class="fa-solid fa-key"></i> Code Request Created
        </span>
      </div>

      <div class="timeline-desc">Request for building access code created</div>

      <div class="timeline-footer">
        <span><b>By:</b> Ahmed</span>
        <span><b>Role:</b> Platform Dispatcher</span>
        <span><b>IP:</b> 192.168.1.12</span>
        <span class="meta-badge">user</span>
      </div>
      <div class="meta-toggle"> <i class="fa-solid fa-chevron-down"></i> Click to view metadata</div>
      <div class="meta-content">Device: Mobile · OS: Android · App Version: 1.2.4</div>
    </div>
  </div>

  <!-- 8 -->
  <div class="timeline-item">
    <div class="timeline-dot dot-blue"></div>
    <div class="timeline-card">
      <div class="timeline-header">
        <div>
          <div class="timeline-time">8:45 AM · Feb 22, 2026</div>
          <div class="timeline-title">Payment Invoice Created</div>
        </div>
        <span class="timeline-badge badge-blue">
          <i class="fa-solid fa-credit-card"></i> Payment Created
        </span>
      </div>

      <div class="timeline-desc">Invoice generated for job services</div>

      <div class="timeline-footer">
        <span><b>By:</b> System Billing</span>
        <span><b>Role:</b> System</span>
        <span class="meta-badge">system</span>
      </div>
      <div class="meta-toggle"> <i class="fa-solid fa-chevron-down"></i> Click to view metadata</div>
      <div class="meta-content">Device: Mobile · OS: Android · App Version: 1.2.4</div>
    </div>
  </div>

  <!-- 9 -->
  <div class="timeline-item">
    <div class="timeline-dot dot-green"></div>
    <div class="timeline-card">
      <div class="timeline-header">
        <div>
          <div class="timeline-time">4:22 PM · Feb 21, 2026</div>
          <div class="timeline-title">Job Created</div>
        </div>
        <span class="timeline-badge badge-green">
          <i class="fa-solid fa-circle-check"></i> Job Created
        </span>
      </div>

      <div class="timeline-desc">New service request created by customer</div>

      <div class="timeline-footer">
        <span><b>By:</b> John Anderson</span>
        <span><b>Role:</b> Platform Admin</span>
        <span><b>IP:</b> 192.168.1.10</span>
        <span class="meta-badge">user</span>
      </div>
      <div class="meta-toggle"> <i class="fa-solid fa-chevron-down"></i> Click to view metadata</div>
      <div class="meta-content">Device: Mobile · OS: Android · App Version: 1.2.4</div>
    </div>
    </div>

    </div>
    </div>
    </div>
    </div>
    <!--End OF JOB DETAILS MODAL  -->
    </main>
    </div>

  <!-- JS -->
  <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
  <script src="../assets/js/bootstrap.bundle.min.js"></script>
  <script src="../assets/js/script.js"></script>

<script>
//// Company Table Logic ////

let jobsTable;

const MOCK_JOBS = [
  {id:"JOB-1234", company:"QuickLock Services", type:"Emergency Lockout", customer:"John Doe", technician:"John Smith", status:"In Progress", priority:"High", amount:150},
  {id:"JOB-1235", company:"SecureAccess Inc", type:"Routine Maintenance", customer:"Jane Smith", technician:"Alice Johnson", status:"Completed", priority:"Medium", amount:200},
  {id:"JOB-1236", company:"MasterKey Solutions", type:"Emergency Lockout", customer:"Bob Wilson", technician:"Charlie Brown", status:"Assigned", priority:"High", amount:180},
  {id:"JOB-1237", company:"City Lock & Key", type:"New Installation", customer:"David Lee", technician:"Eva Green", status:"Pending", priority:"Low", amount:120},
  {id:"JOB-1238", company:"Emergency Locksmith Co", type:"Emergency Lockout", customer:"Frank Miller", technician:"Grace Hall", status:"Cancelled", priority:"High", amount:200},
  {id:"JOB-1239", company:"Emergency Locksmith Co", type:"Emergency Lockout", customer:"Jane Smith", technician:"Grace Hall", status:"Assigned", priority:"High", amount:200},
  {id:"JOB-1240", company:"Emergency Locksmith Co", type:"Emergency Lockout", customer:"Jane Smith", technician:"Grace Hall", status:"Assigned", priority:"Medium", amount:200},
  {id:"JOB-1241", company:"Emergency Locksmith Co", type:"Emergency Lockout", customer:"Jane Smith", technician:"Grace Hall", status:"Completed", priority:"Low", amount:200}
];

$(document).ready(function(){

  jobsTable = initDataTable(
    "#jobsTable", MOCK_JOBS, [
      { data: "id" },
      { data: "company" },
      { data: "type" },
      { data: "customer" },
      { data: "technician" },
      { 
        data: "status",
        render: (d) => window.renderStatusBadge(d),
      },
      { 
        data: "priority",
        render: (d) => window.renderStatusBadge(d),
      },
      { 
        data: "amount",
        render: d => `$${d.toLocaleString()}`
      },
      {
      data: null,
      render: (row) => `
        <a href="jobChat.html?id=${row.id}" 
        class="text-decoration-none text-primary fw-semibold">
        View
        </a>`
     },
      { 
      data: null,
      render: () => `<a href="#" class="view-details text-decoration-none text-primary fw-semibold">View</a>`
    }
    ]
  );

  /* Search */
  $("#customSearch").on("keyup",function(){
    jobsTable.search(this.value).draw();
  });

 /* Status Filter */
  $("#statusFilter").on("change", function(){
  const val = this.value;

  if(val){
    jobsTable
      .column(5) 
      .search(val, false, true)
      .draw();
  } else {
    jobsTable
      .column(5)
      .search("")
      .draw();
  }
  });
  
  /* Tabs */
  $(".btn-tab").on("click", function(){
    const filter = $(this).data("filter");
    $(".btn-tab").removeClass("active");
    $(this).addClass("active");
    if(filter === "all"){
      jobsTable.column(6).search("").draw();
    } else if(filter === "high"){
      jobsTable.column(6).search("High").draw();
    } else if(filter === "today"){
      jobsTable.column(6).search("High").draw();
    }
  });

  /* ===== VIEW DETAILS Modal Logic ===== */
    $('#jobsTable tbody').on('click', '.view-details', function(e) {
    e.preventDefault();

    const tr = $(this).closest('tr');
    const data = jobsTable.row(tr).data();

  // Fill modal
  $('#modalJobId').text(data.id);
  $('#modalJobType').text(data.type);
  $('#modalCustName').text(data.customer);
  $('#modalCompany').text(data.company);
  $('#modalTech').text(data.technician);
  $('#modalTotal').text('$' + data.amount);

  // Status badge
  $('#modalStatusBadge').html(
    `<span class="status-badge status-${data.status.toLowerCase().replace(" ","")}">${data.status}</span>`
  );

  // Priority badge
  $('#modalPriorityBadge').html(
    `<span class="status-badge priority-${data.priority.toLowerCase()}">${data.priority}</span>`
  );

  // Show modal
  const modal = new bootstrap.Modal(document.getElementById('jobDetailsModal'));
  modal.show();
    });

    });
  </script>

  </body>
  </html>